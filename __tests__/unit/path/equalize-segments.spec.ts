import type { PathArray } from '../../../src';
import { getDrawDirection } from '../../../src/path/util/get-draw-direction';
import { equalizeSegments } from '../../../src/path/util/equalize-segments';
import { getRotatedCurve } from '../../../src/path/util/get-rotated-curve';

describe('equalize segments', () => {
  it('should calc draw direction correctly', () => {
    const rotated = getRotatedCurve(
      [
        ['M', -100, 100],
        [
          'C',
          -99.99999999999999,
          176.98003589195008,
          -16.66666666666667,
          225.09255832441892,
          49.999999999999986,
          186.60254037844388,
        ],
        ['C', 80.9401076758503, 168.73926088303568, 100, 135.72655899081636, 100, 100],
        ['C', 100, 23.01996410804992, 16.66666666666668, -25.092558324418903, -49.99999999999998, 13.397459621556123],
        ['C', -80.94010767585029, 31.2607391169643, -100, 64.27344100918364, -100, 100],
        ['C', -100, 100, -100, 100, -100, 100],
      ],
      [
        ['M', -100, 100],
        [
          'C',
          -99.99999999999999,
          176.98003589195008,
          -16.66666666666667,
          225.09255832441892,
          49.999999999999986,
          186.60254037844388,
        ],
        ['C', 80.9401076758503, 168.73926088303568, 100, 135.72655899081636, 100, 100],
        ['C', 100, 23.01996410804992, 16.66666666666668, -25.092558324418903, -49.99999999999998, 13.397459621556123],
        ['C', -80.94010767585029, 31.2607391169643, -100, 64.27344100918364, -100, 100],
        ['C', -100, 100, -100, 100, -100, 100],
      ],
    );

    expect(rotated).toEqual([
      ['M', -100, 100],
      [
        'C',
        -99.99999999999999,
        176.98003589195008,
        -16.66666666666667,
        225.09255832441892,
        49.999999999999986,
        186.60254037844388,
      ],
      ['C', 80.9401076758503, 168.73926088303568, 100, 135.72655899081636, 100, 100],
      ['C', 100, 23.01996410804992, 16.66666666666668, -25.092558324418903, -49.99999999999998, 13.397459621556123],
      ['C', -80.94010767585029, 31.2607391169643, -100, 64.27344100918364, -100, 100],
      ['C', -100, 100, -100, 100, -100, 100],
    ]);
  });

  it('should calc draw direction correctly', () => {
    expect(
      getDrawDirection([
        ['M', 0, 0],
        ['L', 100, 100],
      ]),
    ).toBeTruthy();

    expect(
      getDrawDirection([
        ['M', 0, 0],
        ['L', -100, -100],
      ]),
    ).toBeTruthy();

    expect(getDrawDirection([['M', 0, 0], ['L', 100, 100], ['L', 0, 100], ['Z']])).toBeTruthy();

    expect(getDrawDirection([['M', 0, 0], ['L', 0, 100], ['L', 100, 100], ['Z']])).toBeFalsy();
  });

  it('should equalizeSegments correctly', () => {
    const path1: PathArray = [
      ['M', 0, 0],
      ['L', 100, 100],
    ];
    const path2: PathArray = [
      ['M', 0, 0],
      ['L', -100, -100],
    ];
    expect(equalizeSegments(path1, path2)).toEqual([
      [
        ['M', 0, 0],
        ['L', 100, 100],
      ],
      [
        ['M', 0, 0],
        ['L', -100, -100],
      ],
    ]);
  });
});
